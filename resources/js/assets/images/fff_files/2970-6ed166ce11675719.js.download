"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2970],{72970:function(e,n,t){t.d(n,{ZP:function(){return P}});var a=t(82104),l=t(1827),r=t(4239);let u=null,i=async e=>(null==e?void 0:e.skip)===!0?null:(u||(u=(0,a.jo)()),u),o=(0,l.useCachedService)(i,e=>(null==e?void 0:e.skip)!==!0),c=()=>{let{isLogin:e}=(0,r.Z)();return o({skip:!e})};var d=t(47907),_=t(7908),s=t(2265),v=t(51385),p=t(27864),f=t(45858),m=t(89539),g=t.n(m),w=t(41114),y=()=>{let{data:e}=(0,w.K)();return(0,s.useMemo)(()=>{var n,t,a,l,r,u,i,o,c,d,_,s,v,p,f,m,g,w,y,h,k,x,b,S,R,F,I,C,P,E,Z;return{current_plan_tier_id:null==e?void 0:null===(n=e.user_current_plan)||void 0===n?void 0:n.tier_id,current_plan_tier_name:null==e?void 0:null===(t=e.user_current_plan)||void 0===t?void 0:t.tier_name,current_plan_interval:null==e?void 0:null===(a=e.user_current_plan)||void 0===a?void 0:a.interval,current_plan_interval_count:null==e?void 0:null===(l=e.user_current_plan)||void 0===l?void 0:l.interval_count,current_plan_start_date:null==e?void 0:null===(r=e.user_current_plan)||void 0===r?void 0:r.start_date,current_plan_end_date:null==e?void 0:null===(u=e.user_current_plan)||void 0===u?void 0:u.end_date,current_plan_amount:null==e?void 0:null===(i=e.user_current_plan)||void 0===i?void 0:i.amount,current_plan_currency:null==e?void 0:null===(o=e.user_current_plan)||void 0===o?void 0:o.currency,current_plan_product:null==e?void 0:null===(c=e.user_current_plan)||void 0===c?void 0:c.product,current_plan_price:null==e?void 0:null===(d=e.user_current_plan)||void 0===d?void 0:d.price,current_plan_active:null==e?void 0:null===(_=e.user_current_plan)||void 0===_?void 0:_.active,current_plan_allow_private_generation:null==e?void 0:null===(s=e.user_current_plan)||void 0===s?void 0:s.allow_private_generation,current_plan_allow_watermark_free_download:null==e?void 0:null===(v=e.user_current_plan)||void 0===v?void 0:v.allow_watermark_free_download,current_plan_max_concurrent_tasks:null==e?void 0:null===(p=e.user_current_plan)||void 0===p?void 0:p.max_concurrent_tasks,current_plan_max_generation_tasks:null==e?void 0:null===(f=e.user_current_plan)||void 0===f?void 0:f.max_generation_tasks,current_plan_max_queue_size:null==e?void 0:null===(m=e.user_current_plan)||void 0===m?void 0:m.max_queue_size,schedule_plan_tier_id:null==e?void 0:null===(g=e.user_next_plan)||void 0===g?void 0:g.tier_id,schedule_plan_tier_name:null==e?void 0:null===(w=e.user_next_plan)||void 0===w?void 0:w.tier_name,schedule_plan_interval:null==e?void 0:null===(y=e.user_next_plan)||void 0===y?void 0:y.interval,schedule_plan_interval_count:null==e?void 0:null===(h=e.user_next_plan)||void 0===h?void 0:h.interval_count,schedule_plan_start_date:null==e?void 0:null===(k=e.user_next_plan)||void 0===k?void 0:k.start_date,schedule_plan_end_date:null==e?void 0:null===(x=e.user_next_plan)||void 0===x?void 0:x.end_date,schedule_plan_amount:null==e?void 0:null===(b=e.user_next_plan)||void 0===b?void 0:b.amount,schedule_plan_currency:null==e?void 0:null===(S=e.user_next_plan)||void 0===S?void 0:S.currency,schedule_plan_product:null==e?void 0:null===(R=e.user_next_plan)||void 0===R?void 0:R.product,schedule_plan_price:null==e?void 0:null===(F=e.user_next_plan)||void 0===F?void 0:F.price,schedule_plan_allow_private_generation:null==e?void 0:null===(I=e.user_next_plan)||void 0===I?void 0:I.allow_private_generation,schedule_plan_allow_watermark_free_download:null==e?void 0:null===(C=e.user_next_plan)||void 0===C?void 0:C.allow_watermark_free_download,schedule_plan_max_concurrent_tasks:null==e?void 0:null===(P=e.user_next_plan)||void 0===P?void 0:P.max_concurrent_tasks,schedule_plan_max_generation_tasks:null==e?void 0:null===(E=e.user_next_plan)||void 0===E?void 0:E.max_generation_tasks,schedule_plan_max_queue_size:null==e?void 0:null===(Z=e.user_next_plan)||void 0===Z?void 0:Z.max_queue_size}},[e])},h=()=>{let e=y();return(0,s.useMemo)(()=>({...e}),[e])};let k="b429725f203b84389f901b0b5161e09f",x=!1,b=()=>{let e=Date(),n={PageURL:window.location.href,PageDomain:window.location.hostname,PagePath:window.location.pathname,PageLocation:window.location.origin,PageTitle:document.title,using_reverse_proxy:x,referer:document.referrer,version:"v0.10.18-4-g8c3f6b54-20240925",utc_date:(0,p.db)(e),utc_time:(0,p.Wc)(e),utc_datetime:(0,p.y1)(e)};try{let t=localStorage.getItem(f.$);t&&(n.uid=t);let a=localStorage.getItem(f.Yg);if(a){let t=g()(a);n.user_create_time=(0,p.y1)(t),n.user_create_date=(0,p.db)(t),n.is_new_user=(0,p.db)(t)===(0,p.db)(e)}for(let e of f.r4){let t=localStorage.getItem(e);t&&(n[e]=t)}}catch(e){return{}}return n},S=async()=>{var e;try{await _.Z.post("https://api2.amplitude.com/2/httpapi",{api_key:k,events:[],client_upload_time:new Date().toISOString(),options:{}})}catch(e){(0,p.S$)("Failed to ping Amplitude API",e),x=!0}let n=null!==(e=localStorage.getItem(f.$))&&void 0!==e?e:"";(0,v.S1)(k,n,{defaultTracking:{sessions:!0},...x?{serverUrl:"https://revproxy.haiper.ai/amp/2/httpapi"}:{}})},R=null,F=async()=>{p.yv&&(R||(R=S()),await R)},I=e=>{(0,v.Iv)(e),void 0===e?localStorage.removeItem(f.$):localStorage.setItem(f.$,e)},C=e=>{if(!e){localStorage.removeItem(f.Yg);return}localStorage.setItem(f.Yg,e)};var P=()=>{let{data:e,isValidating:n}=c(),t=(0,s.useRef)(n);(0,s.useEffect)(()=>{t.current=n},[n]);let a=(0,s.useCallback)(()=>new Promise(e=>{if(t.current){let n=setInterval(()=>{t.current||(clearInterval(n),e())},100)}else e()}),[]),l=(0,d.useSearchParams)();(0,s.useEffect)(()=>{for(let e of f.r4){let n=null==l?void 0:l.get(e);n&&localStorage.setItem(e,n)}},[l]),(0,s.useEffect)(()=>{(null==e?void 0:e.id)&&I(e.id)},[e]),(0,s.useEffect)(()=>{F().catch(console.error)},[]);let r=h(),u=(0,s.useRef)(r);return(0,s.useEffect)(()=>{u.current=r},[r]),{track:(0,s.useCallback)(async(e,n)=>{await F(),await a();let t={...u.current,...b(),...n};p.yv?(0,v.j)(e,t):(0,p.S$)("[Amplitude Event]","(uid: ".concat((0,v.n5)(),"):"),e,t)},[a]),setUserId:I,setUserCreateTime:C}}},4239:function(e,n,t){var a=t(26583),l=t(45858),r=t(27864),u=t(63332),i=t(78757),o=t(2265);n.Z=()=>{let{loginWithRedirect:e,isAuthenticated:n,isLoading:t,logout:c,getAccessTokenSilently:d,getIdTokenClaims:_,error:s}=(0,u.D3)(),[v,p]=(0,i.KO)(a.cq),f=(0,i.b9)(a.hz),m=(0,i.b9)(a.Mq),g=(0,i.b9)(a.PC),w=(0,o.useCallback)(()=>{let n="".concat(window.location.pathname).concat(window.location.search);sessionStorage.setItem(l.ZT,n),m(!1),e()},[e,m]);(0,o.useEffect)(()=>{f(t)},[t,f]);let y=(0,o.useCallback)(e=>n?d(e).then(e=>{"string"==typeof e&&(localStorage.setItem("token",e),p(!0))}):Promise.resolve("not login"),[d,p,n]),h=(0,o.useCallback)(async()=>{var e;let n=await _();g(null!==(e=null==n?void 0:n.first_login)&&void 0!==e&&e)},[_,g]);return(0,o.useEffect)(()=>{let e=(0,r.$o)("token",{raw:!0});!e&&n?y():e?p(!0):p(!1)},[n,y,p]),(0,o.useEffect)(()=>{n&&h()},[n,h]),{loginWithRedirect:e,isLogin:v,isLoading:t,logout:(0,o.useCallback)(e=>{c(e).then(()=>{(0,r.lS)()})},[c]),refreshToken:y,setIsLogin:p,error:s,login:w}}},41114:function(e,n,t){t.d(n,{K:function(){return d}});var a=t(95814),l=t(1827),r=t.n(l),u=t(4239),i=t(2265);let o=async e=>(null==e?void 0:e.skip)?null:await (0,a.Bc)();r()(o,e=>!(null==e?void 0:e.skip));let c=(0,l.useCachedService)(o,e=>!(null==e?void 0:e.skip)),d=()=>{let{isLogin:e}=(0,u.Z)(),{data:n,isValidating:t,refresh:a}=c((0,i.useMemo)(()=>e?{}:{skip:!0},[e]));return{data:null!=n?n:null,loading:t,refresh:a}}},82104:function(e,n,t){t.d(n,{Ai:function(){return u},ck:function(){return i},jm:function(){return l},jo:function(){return r}});var a=t(27864);let l=async e=>(await a.RF.get("/v1/auth/discord",{params:{code:e,redirect_uri:"".concat(window.location.origin,"/auth/callback/discord")}})).data,r=async()=>(await a.RF.get("/v1/user/me")).data,u=async()=>(await a.RF.get("/v1/user/profile")).data,i=async e=>(await a.RF.put("/v1/user/profile",e)).data},95814:function(e,n,t){t.d(n,{Bc:function(){return i},LT:function(){return l},Sx:function(){return o},TN:function(){return d},US:function(){return r},Yz:function(){return v},Zo:function(){return c},dU:function(){return _},ku:function(){return u},vC:function(){return s},yD:function(){return p}});var a=t(27864);let l=async()=>(await a.RF.get("/v1/pay/get-pricing-table")).data,r=async e=>(await a.RF.post("/v1/pay/create-checkout-session",e)).data,u=async()=>(await a.RF.post("/v1/pay/create-portal-session")).data,i=async()=>(await a.RF.get("/v1/pay/get-user-subscription")).data,o=async e=>(await a.RF.get("/v1/pay/switch-subscription-plan",{params:e})).data,c=async e=>(await a.RF.post("/v1/pay/switch-subscription-plan",e,{meta:{silent:!0}})).data,d=async e=>(await a.RF.post("/v1/pay/stop-pending-cancellation",e)).data,_=async e=>(await a.RF.post("/v1/pay/cancel-subscription-schedule",e)).data,s=async()=>(await a.RF.get("/v1/pay/get-user-credit-balance")).data,v=async()=>(await a.RF.get("/v1/pay/get-credit-pricing-table")).data,p=async e=>(await a.RF.post("/v1/pay/create-credit-checkout-session",e)).data}}]);
//# sourceMappingURL=2970-6ed166ce11675719.js.map